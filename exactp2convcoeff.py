# import necessary stuff for code
import numpy as np

from numpy import *

########################################################################
#symmetric post-processing coefficients for p=2 to confirm whether code works

def exactp2convcoeff(zEval):

    Neval = np.size(zEval)
    exsym0 = np.zeros((9,3,Neval))

    for j in arange(Neval):
        Zeta = zEval[j]
        if Zeta < 0:
            exsym0[0][0][j] = -37/92160 * Zeta ** 3
            exsym0[0][1][j] = -37/368640 * Zeta ** 3 * (Zeta + 4)
            exsym0[0][2][j] = -37/614400 * Zeta ** 5 - 37/122880*Zeta ** 4 - 37/92160 * Zeta ** 3

            exsym0[1][0][j] = 499/92160 * Zeta ** 3 + 37/11520 + 37/15360 * Zeta ** 2 - 37/7680 * Zeta
            exsym0[1][1][j] = 37/23040 - 37/23040 * Zeta + 499/368640 * Zeta ** 4 + 499/92160 * Zeta ** 3
            exsym0[1][2][j] = 499/614400 * Zeta ** 5 + 499/122880 * Zeta ** 4 + 499/92160 * Zeta ** 3 + 37/115200

            exsym0[2][0][j] = -77/2560 * Zeta ** 2 + 97/1920 * Zeta - 1/48 - 433/10240 * Zeta ** 3
            exsym0[2][1][j] = -97/5760 + 77/3840 * Zeta - 433/40960 * Zeta ** 4 -433/10240 * Zeta ** 3
            exsym0[2][2][j] = -1299/204800 * Zeta ** 5 - 1299/40960 * Zeta ** 4 - 433/10240 * Zeta ** 3 - 77/19200

            exsym0[3][0][j] = 229/1024 * Zeta ** 2 - 517/1536 * Zeta + 123/1280 + 1891/18432 * Zeta ** 3
            exsym0[3][1][j] = 517 / 4608 - 229/ 1536 * Zeta + 1891/73728 * Zeta ** 4 + 1891/18432 * Zeta ** 3
            exsym0[3][2][j] = 1891/122880 * Zeta ** 5 + 1891/24576 * Zeta ** 4 + 1891/18432 * Zeta ** 3 + 229/7680

            exsym0[4][0][j] = -1891/18432 * Zeta ** 3 - 301/768 * Zeta ** 2 + 607/720
            exsym0[4][1][j] = -1891/73728 * Zeta * (Zeta ** 3 + 4 * Zeta ** 2 - 19264/1891)
            exsym0[4][2][j] = -301/5760 - 1891/122880 * Zeta ** 5 - 1891/18432 * Zeta ** 3 - 1891/24576 * Zeta ** 4

            exsym0[5][0][j] = 229/1024 * Zeta ** 2 + 517/1536 * Zeta + 123/1280 + 433/10240 * Zeta ** 3
            exsym0[5][1][j] = -517/4608 - 229/1536 * Zeta + 433/40960 * Zeta ** 4 + 433/10240 * Zeta ** 3
            exsym0[5][2][j] = 229/7680 + 1299/204800 * Zeta ** 5 + 1299/40960 * Zeta ** 4 + 433/10240 * Zeta ** 3

            exsym0[6][0][j] = -0.77e2 / 0.2560e4 * Zeta ** 2 - 0.97e2 / 0.1920e4 * Zeta - 0.1e1 / 0.48e2 - 0.499e3 / 0.92160e5 * Zeta ** 3
            exsym0[6][1][j] = 0.97e2 / 0.5760e4 + 0.77e2 / 0.3840e4 * Zeta - 0.499e3 / 0.368640e6 * Zeta ** 4 - 0.499e3 / 0.92160e5 * Zeta ** 3
            exsym0[6][2][j] = -0.499e3 / 0.614400e6 * Zeta ** 5 - 0.499e3 / 0.122880e6 * Zeta ** 4 - 0.499e3 / 0.92160e5 * Zeta ** 3 - 0.77e2 / 0.19200e5

            exsym0[7][0][j] = 0.37e2 / 0.92160e5 * (Zeta + 2) ** 3
            exsym0[7][1][j] = 0.37e2 / 0.368640e6 * (Zeta - 2) * (Zeta + 2) ** 3
            exsym0[7][2][j] = 0.37e2 / 0.115200e6 + 0.37e2 / 0.614400e6 * Zeta ** 5 + 0.37e2 / 0.122880e6 * Zeta ** 4 + 0.37e2 / 0.92160e5 * Zeta ** 3

        elif Zeta>0:
            exsym0[1][0][j] = -0.37e2 / 0.92160e5 * (Zeta - 2) ** 3
            exsym0[1][1][j] = -0.37e2 / 0.368640e6 * (Zeta + 2) * (Zeta - 2) ** 3
            exsym0[1][2][j] = -0.37e2 / 0.614400e6 * Zeta ** 5 + 0.37e2 / 0.122880e6 * Zeta ** 4 - 0.37e2 / 0.92160e5 * Zeta ** 3 + 0.37e2 / 0.115200e6

            exsym0[2][0][j] = 0.499e3 / 0.92160e5 * Zeta ** 3 - 0.77e2 / 0.2560e4 * Zeta ** 2 + 0.97e2 / 0.1920e4 * Zeta - 0.1e1 / 0.48e2
            exsym0[2][1][j] = 0.499e3 / 0.368640e6 * Zeta ** 4 - 0.499e3 / 0.92160e5 * Zeta ** 3 + 0.77e2 / 0.3840e4 * Zeta - 0.97e2 / 0.5760e4
            exsym0[2][2][j] = 0.499e3 / 0.614400e6 * Zeta ** 5 - 0.499e3 / 0.122880e6 * Zeta ** 4 + 0.499e3 / 0.92160e5 * Zeta ** 3 - 0.77e2 / 0.19200e5

            exsym0[3][0][j] = -0.433e3 / 0.10240e5 * Zeta ** 3 + 0.229e3 / 0.1024e4 * Zeta ** 2 - 0.517e3 / 0.1536e4 * Zeta + 0.123e3 / 0.1280e4
            exsym0[3][1][j] = -0.433e3 / 0.40960e5 * Zeta ** 4 + 0.433e3 / 0.10240e5 * Zeta ** 3 - 0.229e3 / 0.1536e4 * Zeta + 0.517e3 / 0.4608e4
            exsym0[3][2][j] = 0.229e3 / 0.7680e4 - 0.1299e4 / 0.204800e6 * Zeta ** 5 + 0.1299e4 / 0.40960e5 * Zeta ** 4 - 0.433e3 / 0.10240e5 * Zeta ** 3


            exsym0[4][0][j] = 0.1891e4 / 0.18432e5 * Zeta ** 3 - 0.301e3 / 0.768e3 * Zeta ** 2 + 0.607e3 / 0.720e3
            exsym0[4][1][j] = 0.1891e4 / 0.73728e5 * Zeta ** 4 - 0.1891e4 / 0.18432e5 * Zeta ** 3 + 0.301e3 / 0.1152e4 * Zeta
            exsym0[4][2][j] = -0.301e3 / 0.5760e4 + 0.1891e4 / 0.18432e5 * Zeta ** 3 + 0.1891e4 / 0.122880e6 * Zeta ** 5 - 0.1891e4 / 0.24576e5 * Zeta ** 4

            exsym0[5][0][j] = -0.1891e4 / 0.18432e5 * Zeta ** 3 + 0.229e3 / 0.1024e4 * Zeta ** 2 + 0.517e3 / 0.1536e4 * Zeta + 0.123e3 / 0.1280e4
            exsym0[5][1][j] = -0.1891e4 / 0.73728e5 * Zeta ** 4 + 0.1891e4 / 0.18432e5 * Zeta ** 3 - 0.229e3 / 0.1536e4 * Zeta - 0.517e3 / 0.4608e4
            exsym0[5][2][j] = 0.229e3 / 0.7680e4 - 0.1891e4 / 0.18432e5 * Zeta ** 3 - 0.1891e4 / 0.122880e6 * Zeta ** 5 + 0.1891e4 / 0.24576e5 * Zeta ** 4

            exsym0[6][0][j] = 0.433e3 / 0.10240e5 * Zeta ** 3 - 0.77e2 / 0.2560e4 * Zeta ** 2 - 0.97e2 / 0.1920e4 * Zeta - 0.1e1 / 0.48e2
            exsym0[6][1][j] = 0.433e3 / 0.40960e5 * Zeta ** 4 - 0.433e3 / 0.10240e5 * Zeta ** 3 + 0.77e2 / 0.3840e4 * Zeta + 0.97e2 / 0.5760e4
            exsym0[6][2][j] = 0.1299e4 / 0.204800e6 * Zeta ** 5 - 0.1299e4 / 0.40960e5 * Zeta ** 4 + 0.433e3 / 0.10240e5 * Zeta ** 3 - 0.77e2 / 0.19200e5

            exsym0[7][0][j] = -0.499e3 / 0.92160e5 * Zeta ** 3 + 0.37e2 / 0.15360e5 * Zeta ** 2 + 0.37e2 / 0.7680e4 * Zeta + 0.37e2 / 0.11520e5
            exsym0[7][1][j] = -0.499e3 / 0.368640e6 * Zeta ** 4 + 0.499e3 / 0.92160e5 * Zeta ** 3 - 0.37e2 / 0.23040e5 * Zeta - 0.37e2 / 0.23040e5
            exsym0[7][2][j] = -0.499e3 / 0.92160e5 * Zeta ** 3 - 0.499e3 / 0.614400e6 * Zeta ** 5 + 0.499e3 / 0.122880e6 * Zeta ** 4 + 0.37e2 / 0.115200e6

            exsym0[8][0][j] = 0.37e2 / 0.92160e5 * Zeta ** 3
            exsym0[8][1][j] = 0.37e2 / 0.368640e6 * Zeta ** 3 * (Zeta - 4)
            exsym0[8][2][j] = 0.37e2 / 0.614400e6 * Zeta ** 5 - 0.37e2 / 0.122880e6 * Zeta ** 4 + 0.37e2 / 0.92160e5 * Zeta ** 3
        else:
            exsym0[1][0][j] = 0.37e2 / 0.11520e5
            exsym0[1][1][j] = 0.37e2 / 0.23040e5
            exsym0[1][2][j] = 0.37e2 / 0.115200e6

            exsym0[2][0][j] = -0.1e1 / 0.48e2
            exsym0[2][1][j] = -0.97e2 / 0.5760e4
            exsym0[2][2][j] = -0.77e2 / 0.19200e5

            exsym0[3][0][j] = 0.123e3 / 0.1280e4
            exsym0[3][1][j] = 0.517e3 / 0.4608e4
            exsym0[3][2][j] = 0.229e3 / 0.7680e4

            exsym0[4][0][j] =  0.607e3 / 0.720e3
            exsym0[4][1][j] = 0.0
            exsym0[4][2][j] = -0.301e3 / 0.5760e4

            exsym0[5][0][j] = 0.123e3 / 0.1280e4
            exsym0[5][1][j] = -0.517e3 / 0.4608e4
            exsym0[5][2][j] = 0.229e3 / 0.7680e4

            exsym0[6][0][j] = -0.1e1 / 0.48e2
            exsym0[6][1][j] = 0.97e2 / 0.5760e4
            exsym0[6][2][j] = -0.77e2 / 0.19200e5

            exsym0[7][0][j] = 0.37e2 / 0.11520e5
            exsym0[7][1][j] = -0.37e2 / 0.23040e5
            exsym0[7][2][j] = 0.37e2 / 0.115200e6

    return exsym0
########################################################################
